## Apache Velocity template
## Please see http://velocity.apache.org/engine/2.0/translations/user-guide_fr.html
##
# This is an $boardName board with a single $mcu.getName() chip
#
# Generated by STM32CubeIDE
# Take care that such file, as generated, may be overridden without any early notice. Please have a look to debug launch configuration setup(s)

#set( $fileExtension = ".cfg" )
#if ( (($mcu.getName().contains("STM32MP15")) && ($apNum == 0)) || (($mcu.getName().contains("STM32MP")) && !($mcu.getName().contains("STM32MP15"))) )
source [find board/$boardName$fileExtension]
#else

source [find interface/stlink-dap.cfg]

#if ($isShareableDevice)
st-link interface server
#end

## Limit work area size to 32K
#if ($mcu.getWorkAreaSize() < (32 * 1024))
#set($Integer = 0)
set WORKAREASIZE 0x$Integer.toHexString($mcu.getWorkAreaSize())
#else
set WORKAREASIZE 0x8000
#end

#if ($dbgInterface.name() == "SWD")
transport select "dapdirect_swd"
#elseif ($dbgInterface.name() == "JTAG")
transport select "dapdirect_jtag"
#end

set CHIPNAME $mcu.getName()
set BOARDNAME $boardName

# Enable debug when in low power modes
#if ($isLowPowerModeAllowed)
set ENABLE_LOW_POWER 1
#else
set ENABLE_LOW_POWER 0
#end

# Stop Watchdog counters when halt
#if ($isWatchdogStopWhenHaltedAllowed)
set STOP_WATCHDOG 1
#else
set STOP_WATCHDOG 0
#end

# STlink Debug clock frequency
#set ($CLOCKFREQ = ($dbgInterfaceFrequency.intValue()/1000))
set CLOCK_FREQ $CLOCKFREQ

# ACCESS PORT NUMBER
set AP_NUM $apNum
# GDB PORT
set GDB_PORT $gdbPort

#set( $fileSuffix = "x" )

#set( $fileExtension = ".cfg" )
source [find target/$mcu.getSerie().getName().toLowerCase()$fileSuffix$fileExtension]

#if ($mcu.getName().contains("STM32MP15") && $dbgInterface.name() == "JTAG")
# MPU Reset
reset_config trst_and_srst separate
#elseif ($mcu.getName().contains("STM32MP15") && $dbgInterface.name() == "SWD")
# MPU Reset
reset_config srst_only
#end

#end